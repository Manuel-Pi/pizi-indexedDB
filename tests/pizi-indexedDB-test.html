<html>
<head>
  <meta charset="utf-8">
  <title>pizi-indexedDB global test</title>
  <link rel="stylesheet" href="//code.jquery.com/qunit/qunit-1.18.0.css">
</head>
<body>
  <div id="qunit"></div>
  <div id="qunit-fixture"></div>
  <script src="//code.jquery.com/jquery-2.1.4.min.js"></script>
  <script src="//code.jquery.com/qunit/qunit-1.18.0.js"></script>
  <script src="pizi-indexedDB.js"></script>
  <script>
	  	var root = this;
		QUnit.test( "Root module declaration", function( assert ) {
			assert.ok( root.piziIndexedDB, "Module initialized!" );
			assert.ok( root.piziIndexedDB.open, "Open function available!" );
			assert.ok( root.piziIndexedDB.remove, "Save function available!" );
			assert.ok( root.piziIndexedDB.get, "Remove function available!" );
			assert.ok( root.piziIndexedDB.get, "Get function available!" );
			assert.ok( root.piziIndexedDB.getAll, "GetAll function available!" );
		});
	  
	  	QUnit.test( "AMD module declaration", function( assert ) {
		 	var requireLoadingDone = assert.async();
			$.getScript("//cdnjs.cloudflare.com/ajax/libs/require.js/2.1.20/require.min.js", function(){
				assert.ok(define, "RequireJs is loaded!");
				var moduleLoadingDone = assert.async();
				require(['pizi-indexedDB'], function(piziIndexedDB){
					assert.ok(piziIndexedDB, "Module is defined!");
					assert.ok( piziIndexedDB.open, "Open function available!" );
					assert.ok( piziIndexedDB.remove, "Save function available!" );
					assert.ok( piziIndexedDB.get, "Remove function available!" );
					assert.ok( piziIndexedDB.get, "Get function available!" );
					assert.ok( piziIndexedDB.getAll, "GetAll function available!" );
					moduleLoadingDone();
				});
				requireLoadingDone();
			});
	  	});
	  	
		QUnit.test( "Loading store file", function( assert ) {
			var storesLoadingDone = assert.async();
			$.getJSON("pizi-indexedDBStores.json", function(json) {
				assert.ok(json, "Store.json file loaded!");
				root.piziIndexedDB.conf = json;
				root.piziIndexedDB.save('test', {foo: 'foo', bar: 'bar'});
				storesLoadingDone();
			});
		});
	  	
  </script>
</body>
</html>